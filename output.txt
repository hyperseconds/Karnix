================================================================================
KARNIX - COMPLETE NEURAL NETWORK & MATHEMATICAL COMPUTING SYSTEM
================================================================================

=== MATHEMATICAL FOUNDATIONS ===

--- Vector Operations ---
Vector 1: Vector 1: 3 4 5 
Vector 2: Vector 2: 1 2 3 
Addition Result: Addition Result: 4 6 8 
Subtraction Result: Subtraction Result: 2 2 2 
Scalar Multiplication Result: Scalar Multiplication Result: 6 8 10 
Vector Norm (Magnitude): Vector Norm (Magnitude): 7.07107

--- Matrix Operations ---
Matrix 1:
1 2 3 
4 5 6 
Matrix 2:
7 8 9 
10 11 12 
Addition Result:
8 10 12 
14 16 18 
Subtraction Result:
-6 -6 -6 
-6 -6 -6 
Scalar Multiplication Result:
3 6 9 
12 15 18 
Transpose Result:
1 4 
2 5 
3 6 
Matrix Norm (Frobenius): 9.53939

=== Advanced Matrix Operations ===
Matrix:
4 2 
1 3 
Matrix Trace: 7
Matrix Rank: 2
Eigenvalues: 5 2 
Eigenvectors:
v1: [1, 1]
v2: [-0.5, 1]
Original vector b: [5, 3]
Projection of b onto matrix column space: [5.41176, 1.35294]

=== 3x3 Matrix Example ===
Matrix:
1 2 3 
4 5 6 
7 8 9 
Matrix Trace: 15
Matrix Rank: 2
Eigenvalue computation for 3x3 matrix requires advanced numerical methods
Conceptually: solve det(A - λI) = 0
Original vector b: [1, 2, 3]
Projection of b onto matrix column space: [0.454545, 1.81818, 3.18182]

=== Calculus Operations ===
Constant function f(x) = 5: 5
Derivative of constant: 0
Linear function f(x) = 2x + 3: 7
Polynomial f(x) = 1 + 2x + 3x² at x=2: 17
Polynomial derivative at x=2: 14
Exponential e^x at x=2: 7.38906
Exponential derivative at x=2: 7.38906
Natural log ln(x) at x=2: 0.693147
Logarithmic derivative at x=2: 0.5
Sine sin(x) at x=2: 0.909297
Sine derivative cos(x) at x=2: -0.416147
Cosine cos(x) at x=2: -0.416147
Cosine derivative -sin(x) at x=2: -0.909297
Composite function f(g(x)) where g(x)=x+1, f(u)=u² at x=2: 9
Composite derivative using chain rule at x=2: 6
Multivariate f(x,y) = x² + y² at (2,3): 13
Gradient at (2,3): (4, 6)

=== AI/ML Advanced Calculus ===

=== AI/ML Calculus Demonstrations ===
Sigmoid derivative at x=1.0: 0.196612
∫x² dx from 0 to 2: 2.66667
Gradient of f(x,y) = x²y + xy² at (2,3): [21, 16]
Hessian matrix (for optimization algorithms):
Hessian matrix at (2, 3):
[0, 0]
[0, 0]

--- Individual AI Calculus Operations ---
Differentiation at x=2: 1
Integration from -1 to 1: 0.682689
Gradient at (1.5, 2.5): [8, 8]
Jacobian matrix at (1, 2):
[1, 1]
[2, 1]
Hessian matrix at (0.5, 1):
[1.11022, 1.11022]
[1.11022, 3.33067]

=== Graph Visualizations ===

1. Trigonometric Function:
                             Sine Wave: y = sin(x)
================================================================================
                                       |-                                       
                                       |                                        
                                       |                                        
                                       |                                        
       ** * **                         |-     * *** *                           
     *        *                        |     **      *                          
     *         *                       |    *         **                        
    *          *                       |   *                                    
  *              *                     | *              *                       
  *               *                    |-               *                       
*                                      | *               *                      
*                  *                   |*                  *                    
--------------------*------------------*--------------------*------------------*
|              |    *          |      *|       |               |              *|
                      *                |-                    *              *   
                       *             * |                      *             *   
                                    *  |                       *           *    
                        **         *   |                       *          *     
                          *      **    |                         *       *      
                           ** **       |-                         ***** *       
                                       |                                        
                                       |                                        
                                       |                                        
                                       |                                        
                                       |-                                       
================================================================================
X: [-6.3 to 6.3] Y: [-1.5 to 1.5]

2. Quadratic Function:
                          Quadratic Function: y = x²
================================================================================
*                                      |-                                      *
*                                      |                                      * 
 *                                     |                                    *   
   *                                   |                                    *   
    *                                  |-                                  *    
    *                                  |                                  *     
     *                                 |                                 *      
       *                               |                               *        
        *                              |                               *        
        *                              |-                             *         
          *                            |                             *          
           *                           |                            *           
            *                          |                          *             
             **                        |                         **             
               *                       |-                       *               
                *                      |                       *                
                 *                     |                     **                 
                   *                   |                    *                   
                    *                  |                  **                    
                      **               |-               **                      
                        **             |              **                        
                          ***          |           ***                          
                             ***       |        ***                             
                                **** ***** ****                                 
---------------------------------------+----------------------------------------
================================================================================
X: [-5.0 to 5.0] Y: [0.0 to 25.0]

3. Exponential Growth:
                         Exponential Function: y = e^x
================================================================================
                                       |-                                      *
                                       |                                      * 
                                       |                                        
                                       |                                     *  
                                       |-                                   *   
                                       |                                        
                                       |                                   *    
                                       |                                  *     
                                       |                                 *      
                                       |-                               *       
                                       |                               *        
                                       |                              *         
                                       |                            *           
                                       |                            *           
                                       |-                          *            
                                       |                         **             
                                       |                       **               
                                       |                     **                 
                                       |                   **                   
                                       |-              * **                     
                                       |            ****                        
                                       |      * ****                            
                                      **** ****                                 
**** ********* ****** ****** ********* |                                        
---------------------------------------+----------------------------------------
================================================================================
X: [-3.0 to 3.0] Y: [0.0 to 20.0]

4. Logarithmic Function:
                          Natural Logarithm: y = ln(x)
================================================================================
                                                                                
                                                                                
                                                                           *****
                                                           ****************     
                                              *************                     
                                   ******* ***                                  
                            *******                                             
                    * **** *                                                    
                 ****                                                           
            * * *                                                               
          * *                                                                   
        **                                                                      
+-----**------------------------------------------------------------------------
|    *         |               |               |               |               |
   **                                                                           
                                                                                
  *                                                                             
 *                                                                              
                                                                                
                                                                                
                                                                                
*                                                                               
                                                                                
                                                                                
                                                                                
================================================================================
X: [0.1 to 10.0] Y: [-3.0 to 3.0]

5. Function and Derivative Comparison:
             Function and its Derivative: f(x)=x³-3x, f'(x)=3x²-3
================================================================================
#### ######### ####                    |-                    ######## ##########
                   #                   |                    #       *           
                                       |                                        
                    #                  |                   #        *           
                    #                  |-                 #                     
                                       |                           *            
                      #                |                 #        *             
                       #**** ***       |               #                        
                    * *         **     |                         *              
                   **   #         **   |-              #        *               
                  *      #          ** |              #                         
                 *        #           **             #         *                
----------------*----------#-----------+**----------#---------*-----------------
|              |           #   |       | * *   |   #         * |               |
               *             #         |-   **    #        **                   
             *                #        |      *  #       **                     
                               ##      |      # #*******                        
             *                   ##    |     ##                                 
            *                      ### | # ##                                   
                                      ##-#                                      
           *                           |                                        
                                       |                                        
          *                            |                                        
                                       |                                        
**** *****                             |-                                       
================================================================================
X: [-3.0 to 3.0] Y: [-5.0 to 5.0]
Legend: * = f(x), # = f'(x)

6. Gradient Field (AI Optimization Context):
                       Gradient Field: f(x,y) = x² + y²
================================================================================
>>>>>      >>        >>       >        >-       >       >>        >>      >>> >>
 >>>>>>>>>> >>>>>     >>>      >       >       >      >>>     >>>>> >>>>>>>>>>> 
   > >>>>  >>>>> >>>   >>>>    >>      >      >>    >>>>   >>> >>>>>  >>>> >>   
> >>>>   >>>>   >>   >   >    > >      >      > >    >   >   >>   >>>>   >>>> >>
 >> >>>>    >>>   >>  >>  >    >>      >-     >>    >  >>  >>   >>>    >>>> >>  
   >>   >>>>   >>>      >>     >       >       >     >>      >>>   >>>>   >>    
>>>>>>>    >>>    >> >>   >   > >      >      > >   >   >> >>    >>>    >>>>> >>
  >>>>>>>>>  >>>>      >>      >       >       >      >>      >>>>  >>>>>>>>>>  
     >>    >>>   >>>     >>     >      >      >     >>     >>>   >>>    >>      
>>>>>>>>   >>>>      >>>      >        >-       >      >>>      >>>>   >>>>>>>>>
   >>>> >>>>>> >>>>>    >>>    >>      >      >>    >>>    >>>>> >>>>>> >>>>    
                                       |                                        
>>>>>>>>>>>>>>>>>>>>->>>>>>--->>>------>------>>>--->>>>>>->>>>>>>>>>>>>>>>>>>>>
|              |               |       |       |               |               |
>>>>>>>>>>>>>>>>>>>> >>>>>>   >>>      >-     >>>   >>>>>> >>>>>>>>>>>>>>>>>>>>>
                                       |                                        
   >>>> >>>>>> >>>>>    >>>    >>      >      >>    >>>    >>>>> >>>>>> >>>>    
>>>>>>>>   >>>>      >>>      >        >        >      >>>      >>>>   >>>>>>>>>
     >>    >>>   >>>     >>     >      >      >     >>     >>>   >>>    >>      
  >>>>>>>>>  >>>>      >>      >       >-      >      >>      >>>>  >>>>>>>>>>  
>>>>>>>    >>>    >> >>   >   > >      >      > >   >   >> >>    >>>    >>>>> >>
   >>   >>>>   >>>      >>     >       >       >     >>      >>>   >>>>   >>    
 >> >>>>   >>>>  >>>  >> >>    >>      >      >>    >> >>  >>>  >>>>   >>>> >>  
> >>>>>>>>>>>>>>>    > >>     >>       >       >>     >> >    >>>>>>>>>>>>>>>>>>
>>>>>      >>        >>       >        >-       >       >>        >>      >>> >>
================================================================================
X: [-3.0 to 3.0] Y: [-3.0 to 3.0]
Gradient vectors showing direction of steepest ascent

7. Contour Plot (Loss Function Landscape):
              Contour Plot: f(x,y) = x² + y² (circular contours)
================================================================================
                                       |-                                       
                                       |                                        
                             #  #  #  #| #  #  #                                
                       #  #            |          #  #  #                       
                  # #             x x x|-x x               #                    
                #          x x x       |     x  x x x        # #                
              #        x x             |              x x        #              
          # #       x x        ++ ++ + ++ ++ ++ +        x x       #            
         #        xx       ++ +        |         +++        x       #           
        #        x       ++        ooooo-ooo        ++       xx      #          
        #       x       +       ooo    |    ooo       +       x       #         
       #       x       +       oo      |      oo      ++       x      #         
-------#-------x-------+-------oo------+------oo-------+-------x------##--------
|       #      |x       +      |ooo    |   oooo|      +       x|      #        |
        #        x       +++       ooooo-ooo        ++       xx      #          
         #        xx        +++        |        ++++       xx       #           
           #        x x        + ++ ++ ++ ++ ++          x         #            
            # #         xx             |            x x x        #              
                #          x  x x      |      x x x          #  #               
                  #  #            x x  x-x x             # #                    
                        # #            |           #  #                         
                             #  #  #   #  #  #  #                               
                                       |                                        
                                       |                                        
                                       |-                                       
================================================================================
X: [-5.0 to 5.0] Y: [-5.0 to 5.0]
Contour levels: o=1, +=4, x=9, #=16

8. Data Analysis - Scatter Plot with Regression:
                        Scatter Plot: Sample Data Points
================================================================================
|-                                                                            --
|                                                                         ----  
|                                                                     -- -      
|                                                                 - --          
|-                                                             ---              
|                                                          ----                 
|                                                      ----                     
|                                              o    ---                         
|                                               ----                            
|-                                     o    ---        o                        
|                                       -- -                                    
|                                    ---                                        
|                      o         ---                                            
|                            ----                                               
|-                        ---  o                                                
|                     ----                                                      
|              o - --                                                           
|             ----                                                              
|          ---                                                                  
|-     -- -                                                                     
|  ----                                                                         
---            o                                                                
|                                                                               
|                                                                               
+-------------------------------------------------------------------------------
================================================================================
X: [0.0 to 10.0] Y: [0.0 to 10.0]
Trend line: y = 0.89x + 0.94

9. Custom AI Function Visualization:
                   Neural Network Activation: Sigmoid vs ReLU
================================================================================
                                       |-                                     rr
                                       |                                    r   
                                       |                                  rr    
                                       |                               r r      
                                       |-                             rr        
                                       |                             r          
                                       |                          r r           
                                       |                         rr             
                                       |                       rr               
                                       |-                    rr                 
                                       |                    r                   
                                       |                  rr                    
                                       |                rr                      
                                       |              rr                        
                                       |-           rr                          
                                       |           r                            
                                       |         rr                             
                                       |      r r      ssssssssssss ssss ssss ss
                                       |     rr sssssss                         
                                     sss-s rr                                   
                            ssssssss   | r                                      
rr-rrr-rr-rrrrrrrr-rr-rrrrrrrrrrrrrr-rrrr---------------------------------------
|              |               |       |       |               |               |
                                       |                                        
                                       |-                                       
================================================================================
X: [-5.0 to 5.0] Y: [-0.5 to 5.0]
Legend: s = Sigmoid, r = ReLU

10. Loss Function Landscape:
                 Quadratic Loss Function: L = (x-2)² + (y-1)²
================================================================================
             |-                                                                 
             |                                                                  
             |                                                          *       
             |                                                                  
             |-                                                  *              
             |                                                                  
             |                                             *                    
             |                                                                  
             |                                      *                           
             |-                                                                 
             |                                *                                 
             |                                                                  
             |                         *                                        
             |                                                                  
             |-                                                                 
             |                                                                  
-------------+------------------------------------------------------------------
|            | |               |               |               |               |
             |                                                                  
             |-                                                                 
             |                                                                  
             |                                                                  
             |                                                                  
             |                                                                  
             |-                                                                 
================================================================================
X: [-1.0 to 5.0] Y: [-2.0 to 4.0]
M = Global Minimum, * = Gradient Descent Path

=== Computational Graph & Autograd ===

=== Simple Operations Demo ===
Forward pass complete. z = 25.0

=== Backward Pass ===
Processing: z=x^2+2xy+y^2
Node: z=x^2+2xy+y^2 | Value: 25.0 | Grad: 1.0

Final gradients:
∂z/∂x = 0.0 (expected: 2x+2y = 10)
∂z/∂y = 0.0 (expected: 2x+2y = 10)

=== Neural Network Demo ===
Neural Network Forward Pass:
Input: 1.5
Linear: 0.8
Output (sigmoid): 0.7
Target: 0.8
Loss: 0.0

=== Backward Pass ===
Processing: loss
Node: loss | Value: 0.0 | Grad: 1.0

Gradients for backpropagation:
∂L/∂weight = 0.0
∂L/∂bias = 0.0
∂L/∂input = 0.0

=== Chain Rule Demo ===
Chain: f(g(h(x))) = exp(sin(x^2))
x = 1.0
h(x) = x^2 = 1.0
g(h) = sin(h) = 0.8
f(g) = exp(g) = 2.3

=== Backward Pass ===
Processing: f=exp(g)
Node: f=exp(g) | Value: 2.3 | Grad: 1.0

Chain rule gradient:
Computed ∂f/∂x = 0.0
Manual ∂f/∂x = 2.5
Difference: 2.5

=== Polynomial Regression with Autograd ===
Polynomial Model: y = a*x^3 + b*x^2 + c*x + d
Data point: x = 2.0, y_target = 7.0
Initial prediction: 15.0
Initial loss: 32.0

=== Backward Pass ===
Processing: polynomial_loss
Node: polynomial_loss | Value: 32.0 | Grad: 1.0

Gradients for parameter updates:
∂L/∂a = 0.0 (should move a towards 2)
∂L/∂b = 0.0 (should move b towards -3)
∂L/∂c = 0.0 (should move c towards 1)
∂L/∂d = 0.0 (should move d towards 1)

=== Activation Function Gradients ===
Input: 0.5
Sigmoid output: 0.6
ReLU output: 0.5

=== Backward Pass ===
Processing: sigmoid
Node: sigmoid | Value: 0.6 | Grad: 1.0

=== Backward Pass ===
Processing: relu
Node: relu | Value: 0.5 | Grad: 1.0
Sigmoid gradient: 0.2
ReLU gradient: 1.0

============================================================
DEEP LEARNING NEURAL NETWORK COMPONENTS
============================================================

=== Tensor Operations ===
Input Tensor Tensor(shape=[2, 3, 4]):
[
  [
    [0.5254, 2.8941, -1.1052, 0.7606],
    [-0.9471, 2.4271, 0.0699, -0.4432],
    [0.9363, -0.0409, 1.3780, 0.5517]],
  [
    [0.8236, 0.1292, 0.6007, 1.5297],
    [0.5493, -0.0457, 0.6141, 0.2681],
    [-1.4082, -1.3589, -0.7477, -0.0650]]]
Weight tensor initialized with Xavier initialization

=== Activation Functions ===
Activation Input Tensor(shape=[1, 5]):
[
  [-2.0000, -1.0000, 0.0000, 1.0000, 2.0000]]
ReLU Output Tensor(shape=[1, 5]):
[
  [0.0000, 0.0000, 0.0000, 1.0000, 2.0000]]
ReLU Gradient Input Tensor(shape=[1, 5]):
[
  [0.0000, 0.0000, 0.0000, 1.0000, 1.0000]]
Sigmoid Output Tensor(shape=[1, 5]):
[
  [0.1192, 0.2689, 0.5000, 0.7311, 0.8808]]
Softmax Output Tensor(shape=[1, 4]):
[
  [0.0321, 0.0871, 0.2369, 0.6439]]

=== Convolution Layer ===
ConvolutionLayer:
  Input channels: 3
  Output channels: 16
  Kernel size: 3x3
  Stride: 1x1
  Padding: 1x1
  Use bias: Yes
  Parameters: 448
Convolution input shape: [3, 8, 8]
Convolution Output Tensor(shape=[16, 8, 8]):
  [1024 elements] min=-4.5598, max=4.7127, mean=-0.0719
Convolution backward pass completed
Weight gradient norm: -34.3108

=== Pooling Layers ===
MaxPoolingLayer:
  Pool size: 2x2
  Stride: 2
Pooling Input Tensor(shape=[2, 4, 4]):
[
  [
    [-0.0478, -0.0700, -0.1325, -0.0339],
    [-2.3208, 0.0721, -1.3335, 0.4176],
    [0.6644, 0.6105, 0.1499, -0.5226],
    [-0.8266, 0.4710, 0.1477, -0.1272]],
  [
    [2.6927, -1.7378, 0.0975, 0.2449],
    [0.3169, 1.2105, -0.3094, -0.3635],
    [-0.3193, -0.1628, -0.8997, -2.1372],
    [0.4400, -1.1753, 0.2987, 1.1471]]]
Max Pool Output Tensor(shape=[2, 2, 2]):
[
  [
    [0.0721, 0.4176],
    [0.6644, 0.1499]],
  [
    [2.6927, 0.2449],
    [0.4400, 1.1471]]]
Average Pool Output Tensor(shape=[2, 2, 2]):
[
  [
    [-0.5916, -0.2706],
    [0.2299, -0.0880]],
  [
    [0.6206, -0.0826],
    [-0.3043, -0.3978]]]
Global Average Pool Output Tensor(shape=[2]):
[-0.1801, -0.0410]

=== Fully Connected Layer ===
FullyConnectedLayer:
  Input size: 8
  Output size: 3
  Use bias: Yes
  Parameters: 27
FC Input Tensor(shape=[8]):
[0.5294, 0.0497, 0.5680, -0.2686, -0.5944, 0.2835, -0.9893, 0.2813]
FC Output Tensor(shape=[3]):
[0.0634, -0.4624, -0.6344]
FC Gradient Input Tensor(shape=[8]):
[-0.0550, 0.1991, -0.0316, -0.0400, 0.2075, 0.1487, -0.0316, -0.0538]

=== Optimizers ===
Initial Parameters Tensor(shape=[2, 2]):
[
  [1.0000, 2.0000],
  [3.0000, 4.0000]]
Gradients Tensor(shape=[2, 2]):
[
  [0.1000, 0.2000],
  [0.3000, 0.4000]]
SGD Optimizer:
  Learning rate: 0.1000
Parameters after SGD update Tensor(shape=[2, 2]):
[
  [0.9900, 1.9800],
  [2.9700, 3.9600]]
Adam Optimizer:
  Learning rate: 0.0100
  Beta1: 0.9000
  Beta2: 0.9990
  Epsilon: 0.0000
  Time step: 0
  Tracked parameters: 0
Adam step 1: param[0] = 0.9900
Adam step 2: param[0] = 0.9800
Adam step 3: param[0] = 0.9700

=== Loss Functions ===
MSE Loss: 0.0100
MSE Gradient Tensor(shape=[3]):
[-0.0333, 0.0333, -0.0667]
Cross-Entropy Loss: 0.4644
Cross-Entropy Gradient Tensor(shape=[3]):
[0.2312, -0.3715, 0.1402]

=== Simple Neural Network Example ===
Network Input Tensor(shape=[4]):
[0.5000, -0.2000, 0.8000, -0.1000]
Target Tensor(shape=[2]):
[1.0000, 0.0000]
Network Output Probabilities Tensor(shape=[2]):
[0.6147, 0.3853]
Network Loss: 0.4866
Backward pass completed!
Layer 1 weight gradient sum: -1.1564
Layer 2 weight gradient sum: 0.0000

=== Gradient Checking ===

=== Loss Gradient Check: MSE ===

=== Gradient Check for MSE ===
Parameter shape: [3]
Average relative error: 0.00000000
Maximum relative error: 0.00000000
Tolerance: 0.00001000
Parameters with errors > tolerance: 0/3

Gradient check PASSED
MSE gradient check: PASSED

=== Mini Training Loop ===
Epoch 1 - Loss: 0.48657464 - Prediction: [0.61472846, 0.38527154]
Epoch 2 - Loss: 0.44417573 - Prediction: [0.64135271, 0.35864729]
Epoch 3 - Loss: 0.40876262 - Prediction: [0.66447195, 0.33552805]
Epoch 4 - Loss: 0.37273390 - Prediction: [0.68884851, 0.31115149]
Epoch 5 - Loss: 0.33583027 - Prediction: [0.71474441, 0.28525559]

=== CNN Architecture Example ===
Creating synthetic test images for CNN...
Created gradient test image: 32x32
Converted image to tensor: [3, 32, 32]
Pixel range: [0.00000000, 0.96862745]
Created gradient pattern (32x32 RGB)
Created checkerboard test image: 32x32
Converted image to tensor: [3, 32, 32]
Pixel range: [0.00000000, 1.00000000]
Created checkerboard pattern (32x32 RGB)
Created circles test image: 32x32
Converted image to tensor: [3, 32, 32]
Pixel range: [0.00000000, 0.99607843]
Created circles pattern (32x32 RGB)
Created noise test image: 32x32
Converted image to tensor: [3, 32, 32]
Pixel range: [0.00000000, 1.00000000]
Created noise pattern (32x32 RGB)
Created edges test image: 32x32
Converted image to tensor: [3, 32, 32]
Pixel range: [0.50196078, 1.00000000]
Created edges pattern (32x32 RGB)

Visualizing checkerboard pattern:

Tensor Visualization (Channel 0):
Range: [0.00000000, 1.00000000]
Shape: [32, 32]
==================================
|@@@@    @@@@    @@@@    @@@@    |
|@@@@    @@@@    @@@@    @@@@    |
|@@@@    @@@@    @@@@    @@@@    |
|@@@@    @@@@    @@@@    @@@@    |
|    @@@@    @@@@    @@@@    @@@@|
|    @@@@    @@@@    @@@@    @@@@|
|    @@@@    @@@@    @@@@    @@@@|
|    @@@@    @@@@    @@@@    @@@@|
|@@@@    @@@@    @@@@    @@@@    |
|@@@@    @@@@    @@@@    @@@@    |
|@@@@    @@@@    @@@@    @@@@    |
|@@@@    @@@@    @@@@    @@@@    |
|    @@@@    @@@@    @@@@    @@@@|
|    @@@@    @@@@    @@@@    @@@@|
|    @@@@    @@@@    @@@@    @@@@|
|    @@@@    @@@@    @@@@    @@@@|
|@@@@    @@@@    @@@@    @@@@    |
|@@@@    @@@@    @@@@    @@@@    |
|@@@@    @@@@    @@@@    @@@@    |
|@@@@    @@@@    @@@@    @@@@    |
|    @@@@    @@@@    @@@@    @@@@|
|    @@@@    @@@@    @@@@    @@@@|
|    @@@@    @@@@    @@@@    @@@@|
|    @@@@    @@@@    @@@@    @@@@|
|@@@@    @@@@    @@@@    @@@@    |
|@@@@    @@@@    @@@@    @@@@    |
|@@@@    @@@@    @@@@    @@@@    |
|@@@@    @@@@    @@@@    @@@@    |
|    @@@@    @@@@    @@@@    @@@@|
|    @@@@    @@@@    @@@@    @@@@|
|    @@@@    @@@@    @@@@    @@@@|
|    @@@@    @@@@    @@@@    @@@@|
==================================
CNN Architecture initialized successfully!
Total parameters: 32549

============================================================
CNN ARCHITECTURE SUMMARY
============================================================
Input: [3, 32, 32]
└─ Conv1: 3→16, 3x3, pad=1, stride=1
   └─ ReLU + MaxPool(2x2)
   └─ Output: [16, 16, 16]
└─ Conv2: 16→32, 3x3, pad=1, stride=1
   └─ ReLU + MaxPool(2x2)
   └─ Output: [32, 8, 8]
└─ Conv3: 32→64, 3x3, pad=1, stride=1
   └─ ReLU + GlobalAvgPool
   └─ Output: [64]
└─ FC1: 64→128
   └─ ReLU
└─ FC2: 128→5
   └─ Softmax
   └─ Output: [5] (class probabilities)

Optimizer: Adam (lr=0.00100000)
Total Parameters: 32549
============================================================

Processing images through CNN...
----------------------------------------------------------------------
        Pattern      Predicted     Confidence              Top Classes
----------------------------------------------------------------------
       gradient        Class_3          0.560          C3(0.56)          C1(0.40)
   checkerboard        Class_1          1.000          C1(1.00)          C3(0.00)
        circles        Class_1          0.983          C1(0.98)          C3(0.02)
          noise        Class_1          1.000          C1(1.00)          C3(0.00)
          edges        Class_3          0.599          C3(0.60)          C1(0.38)

Detailed CNN analysis for circles pattern:

=== CNN Forward Pass ===
Input shape: [3, 32, 32]
After Conv1+ReLU+Pool1: [16, 16, 16]
After Conv2+ReLU+Pool2: [32, 8, 8]
After Conv3+ReLU+GlobalPool: [64]
Final output: [5]
Output probabilities:
  Class 0: 0.0013
  Class 1: 0.9829
  Class 2: 0.0000
  Class 3: 0.0158
  Class 4: 0.0000

=== Feature Map Visualizations ===

--- Conv1 Feature Maps ---
Channel 0:

Tensor Visualization (Channel 0):
Range: [0.0000, 2.3286]
Shape: [32, 32]
==========================================
| **+-:.      ..::::-:::.       %|
|-=-.       .::----------:.     +|
|=-.       .:-------======-:.   -|
|=.      .:--==--------====-:.  .|
|-      .:-===--::....:--====-. .|
|:     .-====-:..      .:-====:. |
|.    .:====-:.          .-===-: |
|     :=++=-.             .-===-.|
|    .-=+=-.               :-==-:|
|    :=++-:       ...       :===-|
|   .-++=:      .:---:.     .-===|
|   :=++-.     .:-====:.    .-===|
|   :=+=-     .:-===+=-:     :==+|
|   -=+=:     :-=---=+=:     :==+|
|  .-=+=:     -==:.:=+=-.    :==+|
|  .-=+=:     -++  .-==:     :==+|
|   :===:     :==:.-===:     :==+|
|   :===:     .::.+=+=-.    .-==+|
|   :-==-.     ..:=+=-:     .-===|
|   .-==-:.     .:---:      :=+==|
|    :-==-:       ...      .-=+=-|
|    .:-==-:.             .:=+=-.|
|     .-==--:.            :=++=: |
|      :-==--:..        .:-=+=-. |
|      .:--=--::.      .:-=++-:  |
| .     .:--=---::...::-==+==:   |
| :       .:----------===+=-:    |
|.-:       .::------======-:    .|
|.=-.        .::-----==--:.     -|
|.=--.         ..:::::::.       *|
|.===-:.          ....          @|
|:                               |
==========================================
Channel 1:

Tensor Visualization (Channel 1):
Range: [0.0000, 3.9722]
Shape: [32, 32]
==========================================
|                                |
|+##+=-.                   .:=*#+|
|=*+=:.     ..:-----::.      :-+=|
|-+-:.    .:-=++****+==:.     .--|
|:-:.   .:=+*##%%%%%##*+=:.    ..|
|.:.   :-=*##%%%%%%%%%%#*+-.     |
| .  .:-+*#%%%######%%%%%#+=:    |
|   .:=+*#%##*++===++*#%%%#*=:   |
|   :-+*###*+=-::..:-=+*#%%#+-.  |
|  .-+*###+=-:.      .:=*#%%#+-. |
| .:=*##*+=:.          :=*#%#*=: |
| .-+*##+=:.            :=*#%#+-.|
|.:=*##*=:.   .::-::.   .:+*##*=.|
|.-+*##+-.  .:-=+++=-.   .-*##*=:|
|.-+##*=:.  :-+*##%#+-.  .-+###+:|
|:=*##*=:  .-+*##%@%*=:.  :=*##+-|
|:=*##+-.  :=*###**##+-.  :=*##*-|
|:=*##+-.  :=*##+++##*=:  :=*##*-|
|:=*##+-.  :=*#%#*###*=:  :=*##*-|
|.=*##*=.  .-+#%%%%%#+-.  :=*##+-|
|.-*##*=:   :=*#%%%#*=:. .:=*##+-|
|.-+###+-.  .:=**##*=-.  .-+*#*+:|
|.:=*%#*=:    :-===-:.   :=+##*=:|
| .=*#%#+-.     ....    .-+*##+=:|
| .-+#%%*+-.           .:=*##*+-.|
|  .=*#%%*+-.         .-=*###+=: |
|   :=*%%%#+=:..   ..:-+*###*=:. |
|   .-+*%%%#*+=-----=+*##%#*+-.  |
|.   .-+*%%%%##******##%%#*+-.   |
|:.   .:=*#%%%%%%%%%%%%%#*=-.    |
|-:.   .:=+*#%%%%%%%%%#*+=:.   . |
|-#+-.   .:=+*###%%##*+=-:    :==|
==========================================
Channel 2:

Tensor Visualization (Channel 2):
Range: [0.0000, 2.3946]
Shape: [32, 32]
==========================================
|-+-:.    ..::------:..    .:-+* |
|+=:    .:-==++***++==-:.   .:=+ |
|-:    .-=+*########**+=-..  .:= |
|:    :-+*#%%%%%%%%%%##*+-:.  .: |
|.   :=+##%%%########%%#*+=:.  . |
|   :=*#%%%#**++==++*##%##+=:    |
|  .-+#%%#*+=-:::::-=+*#%##+-.   |
| .-+#%%#*=-:.    ..:-=*#%#*+-.  |
| :=*%%#*=:.         .:=*#%#*=:  |
|.-+#%%*=:.    ...    .:=*#%#+-. |
|:=*%%#+-.   .:---:.   .-+#%#*=. |
|-+#%%*=.   :-=+++=-:   :=*#%#=: |
|-*%%#+:   .-+*###*+-.  .-+#%#+- |
|=*%%#=:   -+#%%%%#*=:.  :+#%#*- |
|=*%%*=.  .-*#%##%%#+-.  :=#%%*- |
|=#%%*-.  .=*%%*+#%#*-.  :=*%%*= |
|=#%%*-.  .=*%%#*%%#*-.  :=*%%*= |
|=*%%*=.  .-*#%###@#+-.  :=#%%*- |
|=*%%*=:  .:+*#####*=:   :+#%#*- |
|-*#%#+-.  .-+*****=:.  .-*#%#+- |
|-+#%#*=:   .-====-:.   :=*%%#=: |
|:=*%%#+-.   .::::.    .-+#%%*=. |
|.-+#%#*=-.           .-+#%%#+:  |
| :=*#%#*=-:.       .:-+*%%#*=.  |
| .-+*#%#*+=-:.....:-=+#%%%*=:   |
|  .-+*#%#**+=-----=+*#%%%#+-.   |
|   :-+*#####**++***#%%%%*+-.    |
|   .:-+*##%#######%%%%#*+-.   . |
|..  .:-=+*###%%%%%%##*+=:.   .- |
|-:.   .:-=+***####**+=-:.   .:= |
|+=:.   ..:--===++==--:.    .:=* |
|.          .......           .. |
==========================================
Channel 3:

Tensor Visualization (Channel 3):
Range: [0.0000, 1.3793]
Shape: [32, 32]
==========================================
|=                         ...   |
|%                         .-=+= |
|#                          .-== |
|+                            := |
|-           .......           - |
|.        ...:::----::.        . |
|       ....:::---====-:         |
|    ..........:::--====:.       |
|   .....         ..:-===-.      |
|  ..:..             :-===:      |
| .:::.               .-==-:     |
| .::.                 .-==-.    |
|.:::.                  :-=-:    |
|:--:                    :==:    |
|:--.      ..:...        :-=-.   |
|---.      :-::.. :      .---.   |
|---.     .---.   .       :--.   |
|-=-.     .-=-.   ..      :--.   |
|-=-.     .-+=-   ..      :-:.   |
|-=-:      -=+=-:::.      :::.   |
|-==:      .=++==-:.      :::    |
|:==-       :-===-:.     ..:.    |
|:===:       .:--:.      ....    |
|.-==-                   ...     |
|.:=+=:                  ...     |
|  -=+=:                 ..      |
|  .-++=:               ...      |
|   :=++=:.            ....      |
|    :=++=-:.        ..:..       |
|.    :-=+==--::...:::::.        |
|:     .-==+===------::..        |
|@-:    .:-=++***++==-:.    .-*% |
==========================================

--- Conv2 Feature Maps ---
Channel 0:

Tensor Visualization (Channel 0):
Range: [0.0000, 29.3212]
Shape: [16, 16]
================================
| =--===++++=-.. |
| +*+==++++**+-..|
| ++==++++++##*=:|
| --=+++=--=+#%#=|
| :=****+=-::+#%#|
| -+*#***+=-.:*%%|
| -*##=-++*+- =#%|
| =##+.-*###+.-*%|
| =#%+ -#%##*:-*#|
| =#%+ .+#+**--*#|
| :#%#: :==++-=*#|
| .+%@*--=++=-+**|
|  -*%%#**+==++**|
| ..-*##*+==+++*+|
| =..-=++++++++=-|
| -:  :-----==-: |
================================
Channel 1:

Tensor Visualization (Channel 1):
Range: [0.0000, 44.5471]
Shape: [16, 16]
================================
|:=:.:--===--::::|
| +=-=+*####*+-:-|
| --=+###*##%#*-:|
| :-+#*+=-=+*%%*-|
|.-=##+-::::-*%%*|
|.-*#+---=--:-*%#|
|.=##+-=*##+-:+#%|
|.+##=:=#%##+.=*@|
|.+##-.+%###+.-*%|
| +##=.-*##*=:=*%|
| =#%+::=++=--+##|
| -*%#=:::---=*#*|
| .=#%#+---==*#*=|
| .:+#%%#****#*+:|
|.-.:=*####**+==:|
| .   ::-----:.  |
================================
Channel 2:

Tensor Visualization (Channel 2):
Range: [0.0000, 4.3415]
Shape: [16, 16]
================================
|                |
|               =|
|               -|
|      .        *|
|               =|
|               .|
|                |
|           .    |
|                |
|     .          |
|               -|
|               %|
|               @|
|               .|
| .+            :|
|                |
================================
Channel 3:

Tensor Visualization (Channel 3):
Range: [0.0000, 9.3443]
Shape: [16, 16]
================================
|:-          :+@.|
|               -|
|                |
|                |
|                |
|                |
|                |
|                |
|                |
|                |
|                |
|                |
|                |
|                |
|                |
|+.            :.|
================================

--- Conv3 Feature Maps ---
Channel 0:

Tensor Visualization (Channel 0):
Range: [0.0000, 105.7602]
Shape: [8, 8]
======================
|+-.  +#.|
|..*=- *.|
|=*@%+.  |
|*#= ==+:|
|=#. +=%.|
| =**::- |
|-  :  +.|
|--   *+ |
======================
Channel 1:

Tensor Visualization (Channel 1):
Range: [0.0000, 168.7342]
Shape: [8, 8]
======================
|.=++***-|
| .==-:==|
| -+==: .|
| -.:-@  |
| ::= - .|
| :*+-: .|
|  -**=- |
|        |
======================
Channel 2:

Tensor Visualization (Channel 2):
Range: [0.0000, 90.1085]
Shape: [8, 8]
======================
|        |
|: -+-   |
|. -=.#- |
|- -  +% |
|+ -#=#+ |
|*. +@*+ |
|*.   :%:|
|=#=  .# |
======================
Channel 3:

Tensor Visualization (Channel 3):
Range: [0.0000, 48.9411]
Shape: [8, 8]
======================
|       -|
|       *|
|      ::|
|  ==# % |
|  @   -+|
| .   # .|
| . + . .|
|      .*|
======================

=== Activation Heatmap ===
Network attention heatmap (where the CNN focuses):

Tensor Visualization (Channel 0):
Range: [0.4637, 1.0000]
Shape: [8, 8]
================================
| =*+=++:|
|:+*=--+=|
|:**%%*+=|
|:+**%#*=|
|:=+****=|
|:+%%%@#=|
|:-=**+*:|
|.-:::--.|
================================

CNN Training Simulation:
Created training dataset with 10 samples

=== Training Epoch 1 ===
Sample 0 - Loss: 1.7952, Predicted: 3, True: 0

Epoch 1 Summary:
Average Loss: 1.6692
Accuracy: 20.00%

=== Advanced Feature Visualization ===
Visualizing learned feature patterns:

Analyzing gradient pattern:
--------------------------------------------------

=== CNN Forward Pass ===
Input shape: [3, 32, 32]
After Conv1+ReLU+Pool1: [16, 16, 16]
After Conv2+ReLU+Pool2: [32, 8, 8]
After Conv3+ReLU+GlobalPool: [64]
Final output: [5]
Output probabilities:
  Class 0: 0.0424
  Class 1: 0.3959
  Class 2: 0.0011
  Class 3: 0.5601
  Class 4: 0.0005

=== CNN Forward Pass ===
Input shape: [3, 32, 32]
After Conv1+ReLU+Pool1: [16, 16, 16]
After Conv2+ReLU+Pool2: [32, 8, 8]
After Conv3+ReLU+GlobalPool: [64]
Final output: [5]
Output probabilities:
  Class 0: 0.0424
  Class 1: 0.3959
  Class 2: 0.0011
  Class 3: 0.5601
  Class 4: 0.0005
Feature extraction summary:
- Conv1 features: Edge detection patterns
- Conv2 features: Texture combinations
- Conv3 features: High-level pattern recognition
Classification probabilities:
  Class 0: 0.0424
  Class 1: 0.3959
  Class 2: 0.0011
  Class 3: 0.5601
  Class 4: 0.0005

Analyzing checkerboard pattern:
--------------------------------------------------

=== CNN Forward Pass ===
Input shape: [3, 32, 32]
After Conv1+ReLU+Pool1: [16, 16, 16]
After Conv2+ReLU+Pool2: [32, 8, 8]
After Conv3+ReLU+GlobalPool: [64]
Final output: [5]
Output probabilities:
  Class 0: 0.0000
  Class 1: 1.0000
  Class 2: 0.0000
  Class 3: 0.0000
  Class 4: 0.0000

=== CNN Forward Pass ===
Input shape: [3, 32, 32]
After Conv1+ReLU+Pool1: [16, 16, 16]
After Conv2+ReLU+Pool2: [32, 8, 8]
After Conv3+ReLU+GlobalPool: [64]
Final output: [5]
Output probabilities:
  Class 0: 0.0000
  Class 1: 1.0000
  Class 2: 0.0000
  Class 3: 0.0000
  Class 4: 0.0000
Feature extraction summary:
- Conv1 features: Edge detection patterns
- Conv2 features: Texture combinations
- Conv3 features: High-level pattern recognition
Classification probabilities:
  Class 0: 0.0000
  Class 1: 1.0000
  Class 2: 0.0000
  Class 3: 0.0000
  Class 4: 0.0000

Analyzing circles pattern:
--------------------------------------------------

=== CNN Forward Pass ===
Input shape: [3, 32, 32]
After Conv1+ReLU+Pool1: [16, 16, 16]
After Conv2+ReLU+Pool2: [32, 8, 8]
After Conv3+ReLU+GlobalPool: [64]
Final output: [5]
Output probabilities:
  Class 0: 0.0013
  Class 1: 0.9829
  Class 2: 0.0000
  Class 3: 0.0158
  Class 4: 0.0000

=== CNN Forward Pass ===
Input shape: [3, 32, 32]
After Conv1+ReLU+Pool1: [16, 16, 16]
After Conv2+ReLU+Pool2: [32, 8, 8]
After Conv3+ReLU+GlobalPool: [64]
Final output: [5]
Output probabilities:
  Class 0: 0.0013
  Class 1: 0.9829
  Class 2: 0.0000
  Class 3: 0.0158
  Class 4: 0.0000
Feature extraction summary:
- Conv1 features: Edge detection patterns
- Conv2 features: Texture combinations
- Conv3 features: High-level pattern recognition
Classification probabilities:
  Class 0: 0.0013
  Class 1: 0.9829
  Class 2: 0.0000
  Class 3: 0.0158
  Class 4: 0.0000

=== Mathematical Neural Network Library Summary ===
Comprehensive deep learning system implemented!
============================================================
Core Components:
✓ Tensor operations with automatic differentiation
✓ Complete CNN architecture (3 conv + 2 FC layers)
✓ Image processing pipeline with synthetic data generation
✓ Multiple activation functions (ReLU, Sigmoid, Tanh)
✓ Advanced optimizers (SGD, Adam, RMSProp)
✓ Loss functions with exact backpropagation
✓ Feature visualization and activation heatmaps
✓ Mathematical precision verified with gradient checking
============================================================
Performance Metrics:
- Total CNN Parameters: 161861
- Input Resolution: 32x32 RGB images
- Output Classes: 5 pattern categories
- Gradient Computation: Verified accurate
System ready for advanced deep learning applications!
